<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mike Johnson">
<meta name="dcterms.date" content="2025-03-10">

<title>Lecture 13</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="13-review_files/libs/clipboard/clipboard.min.js"></script>
<script src="13-review_files/libs/quarto-html/quarto.js"></script>
<script src="13-review_files/libs/quarto-html/popper.min.js"></script>
<script src="13-review_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="13-review_files/libs/quarto-html/anchor.min.js"></script>
<link href="13-review_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="13-review_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="13-review_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="13-review_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="13-review_files/libs/bootstrap/bootstrap-973236bd072d72a04ee9cd82dcc9cb29.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="13-review_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="13-review_files/libs/tabwid-1.1.3/tabwid.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lecture 13</h1>
<p class="subtitle lead">Unit 2: Review</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mike Johnson <a href="mailto:mike.johnson@colostate.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="review-day" class="level1">
<h1>Review Day!</h1>
<section id="component-2-working-with-data" class="level2">
<h2 class="anchored" data-anchor-id="component-2-working-with-data"><strong>Component 2</strong>: <em>Working with Data</em></h2>
<p>Build confidence in wrangling, visualizing, and analyzing data. This section covers importing and cleaning data sets, working with joins, and creating effective visualizations. You’ll also delve into study design, hypothesis testing, and statistical analyses spanning uni-variate, bivariate, and multivariate techniques.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Learning Outcomes</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Import, clean, and merge data sets from diverse sources using core <code>tidyverse</code> packages.</li>
<li>Conduct hypothesis testing and interpret results.</li>
<li>Create impactful visualizations to communicate findings.</li>
</ul>
</div>
</div>
<p>We have covered a ton of material in unit 2.</p>
<div id="fig-elephants" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-elephants-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-elephants" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-surus" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-surus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../slides/images/data-science-eda.png" id="fig-surus" class="img-fluid figure-img" data-ref-parent="fig-elephants">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-surus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-elephants" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-hanno" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-hanno-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../slides/images/tidyverse-implementation.png" id="fig-hanno" class="img-fluid figure-img" data-ref-parent="fig-elephants">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hanno-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elephants-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Data Science: Process and Implementation
</figcaption>
</figure>
</div>
</section>
</section>
<section id="today" class="level1">
<h1>Today</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will look at some public water quality data to examine the relationship between bicarbonate and magnesium/calcium along the Colorado River.</p>
</div>
</div>
<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<p>The balance between bicarbonate and Mg+Ca in water determines hardness, alkalinity, and pH stability, with direct implications for ecosystem health, water treatment, and infrastructure maintenance. The sum of magnesium and calcium concentrations is a key factor in determining water hardness which can impact aquatic ecosystems, water treatment, and infrastructure due to scaling.</p>
<ul>
<li><p>⬆️ bicarbonate + ⬆️ Ca/Mg: Indicates water passing through carbonate-rich geology (limestone/dolomite), leading to high hardness but good buffering capacity.</p></li>
<li><p>⬇️ bicarbonate + ⬆️ Ca/Mg: Suggests non-carbonate sources of Mg and Ca, potentially from industrial pollution or weathering of silicate rocks.</p></li>
<li><p>⬆️ bicarbonate + ⬇️ Ca/Mg: Could be influenced by inputs like agricultural runoff or natural dissolution of bicarbonates from atmospheric CO₂.</p></li>
</ul>
<p>In this lab, we are interested in understanding the relationship between bicarbonate and magnesium/calcium in the Colorado River Basin using a set of gages that have been active over the last ~100 years</p>
<p>Namely, we are interested in:</p>
<ol type="1">
<li>The trend of Bicarbonate over time</li>
<li>The relationship of Bicarbonate to Magnesium + Calcium along the river</li>
<li>The strength of a predictive model for Bicarbonate using the sum Magnesium Calcium</li>
</ol>
</section>
<section id="data-import-setup" class="level2">
<h2 class="anchored" data-anchor-id="data-import-setup">1. Data Import &amp; Setup</h2>
<section id="sometimes-you-need-new-libraries" class="level3">
<h3 class="anchored" data-anchor-id="sometimes-you-need-new-libraries">Sometimes you need new libraries!</h3>
<ul>
<li>We can install from CRAN with <code>install.packages("package_name")</code></li>
<li>We can install from GitHub with <code>remotes::install_github("username/package_name")</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("brunocarlin/tidy.outliers")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="start-with-our-libraries" class="level3">
<h3 class="anchored" data-anchor-id="start-with-our-libraries">Start with our libraries</h3>
<ul>
<li>Here we load the libraries we will use in this lab
<ul>
<li><code>tidyverse</code> for data manipulation</li>
<li><code>tidymodels</code> for modeling</li>
<li><code>dataRetrieval</code> for downloading data</li>
<li><code>flextable</code> for making nice tables</li>
<li><code>visdat</code> for EDA</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.5</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ ggplot2   3.5.1     ✔ tibble    3.2.1</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ purrr     1.0.4     </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)   </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ── Attaching packages ────────────────────────────────────── tidymodels 1.2.0 ──</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ broom        1.0.7     ✔ rsample      1.2.1</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ dials        1.4.0     ✔ tune         1.3.0</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ infer        1.0.7     ✔ workflows    1.2.0</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ modeldata    1.4.0     ✔ workflowsets 1.1.0</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ parsnip      1.3.0     ✔ yardstick    1.3.2</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ recipes      1.1.1     </span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✖ scales::discard() masks purrr::discard()</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✖ dplyr::filter()   masks stats::filter()</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✖ recipes::fixed()  masks stringr::fixed()</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✖ dplyr::lag()      masks stats::lag()</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✖ yardstick::spec() masks readr::spec()</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✖ recipes::step()   masks stats::step()</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; • Use tidymodels_prefer() to resolve common conflicts.</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataRetrieval)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)    </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: 'flextable'</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     compose</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat)       </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>We can predefine our sites of interest for expediency. We do this by creating a data frame with the SiteID and SiteName <code>atomic</code> vectors.</p></li>
<li><p>We can also predefine the variables we are interested in.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">SiteID =</span> <span class="fu">c</span>(<span class="st">"USGS-09069000"</span>, <span class="st">"USGS-09085000"</span>, <span class="st">"USGS-09095500"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"USGS-09152500"</span>, <span class="st">"USGS-09180000"</span>, <span class="st">"USGS-09380000"</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">SiteName =</span> <span class="fu">c</span>(<span class="st">"Eagle"</span>, <span class="st">"Roaring Fork"</span>, <span class="st">"Colorado 3"</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Gunnison"</span>, <span class="st">"Dolores"</span>, <span class="st">"Colorado 5"</span>)) </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>vars  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Magnesium'</span>, <span class="st">'Calcium'</span>, <span class="st">'Bicarbonate'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="explore-the-sites" class="level3">
<h3 class="anchored" data-anchor-id="explore-the-sites">Explore the Sites</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Access</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>site.info <span class="ot">&lt;-</span> <span class="fu">whatWQPsites</span>(<span class="at">siteid =</span> sites<span class="sc">$</span>SiteID) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GET:https://www.waterqualitydata.us/data/Station/search?siteid=USGS-09069000%3BUSGS-09085000%3BUSGS-09095500%3BUSGS-09152500%3BUSGS-09180000%3BUSGS-09380000&amp;mimeType=csv&amp;count=no</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Make a map!</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(site.info) <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">borders</span>(<span class="st">"state"</span>,<span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> LongitudeMeasure, <span class="at">y =</span> LatitudeMeasure, <span class="at">color =</span> MonitoringLocationIdentifier)) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-io" class="level3">
<h3 class="anchored" data-anchor-id="data-io">Data I/O</h3>
<ul>
<li>We can use the <code>dataRetrieval</code> package to download data from the USGS NWIS database.</li>
<li>This provides API access to the USGS NWIS database opposed to reading from a file.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Access</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nwis_wqp <span class="ot">&lt;-</span> <span class="fu">readWQPqw</span>(<span class="at">siteNumbers =</span> sites<span class="sc">$</span>SiteID, <span class="at">parameterCd =</span> vars) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(<span class="at">date =</span> ActivityStartDate,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">parameter =</span> CharacteristicName,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">SiteID =</span> MonitoringLocationIdentifier,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">value  =</span> ResultMeasureValue,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">units  =</span> ResultMeasure.MeasureUnitCode,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">media  =</span> ActivityMediaName) <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(media<span class="sc">==</span><span class="st">'Water'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sites, <span class="at">by =</span> <span class="st">"SiteID"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">'Site'</span>), date, units, parameter, value)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GET:https://www.waterqualitydata.us/data/Result/search?siteid=USGS-09069000%3BUSGS-09085000%3BUSGS-09095500%3BUSGS-09152500%3BUSGS-09180000%3BUSGS-09380000&amp;count=no&amp;characteristicName=Magnesium%3BCalcium%3BBicarbonate&amp;mimeType=csv</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting 2s for throttling delay ■■■■■■■■■■■■■■■</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Waiting 2s for throttling delay ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NEWS: Data does not include USGS data newer than March 11, 2024. More details:</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; https://doi-usgs.github.io/dataRetrieval/articles/Status.html</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(nwis_wqp)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "SiteID"    "SiteName"  "date"      "units"     "parameter" "value"</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="do">## EDA!</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nwis_wqp)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 16,795</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 6</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ SiteID    &lt;chr&gt; "USGS-09180000", "USGS-09180000", "USGS-09180000", "USGS-091…</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ SiteName  &lt;chr&gt; "Dolores", "Dolores", "Dolores", "Dolores", "Dolores", "Dolo…</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ date      &lt;date&gt; 1968-11-18, 1968-11-18, 1968-11-18, 1969-01-29, 1969-01-29,…</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ units     &lt;chr&gt; "mg/l", "mg/l", "mg/l", "mg/l", "mg/l", "mg/l", "mg/l", "mg/…</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ parameter &lt;chr&gt; "Bicarbonate", "Magnesium", "Calcium", "Calcium", "Magnesium…</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ value     &lt;dbl&gt; 148, 72, 132, 98, 55, 168, 124, 43, 10, 17, 78, 112, 76, 27,…</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(nwis_wqp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">nwis_wqp</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">16795</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SiteID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">SiteName</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">units</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">parameter</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">date</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">1926-01-11</td>
<td style="text-align: left;">2024-02-28</td>
<td style="text-align: left;">1966-11-14</td>
<td style="text-align: right;">4536</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">value</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">94.76</td>
<td style="text-align: right;">67.48</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">590</td>
<td style="text-align: left;">▇▅▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(nwis_wqp<span class="sc">$</span>date)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "1926-01-11" "2024-02-28"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(nwis_wqp<span class="sc">$</span>units, nwis_wqp<span class="sc">$</span>parameter)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Bicarbonate Calcium Magnesium</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   mg/l        5645    5577      5573</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_dat</span>(nwis_wqp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="data-tidying-eda" class="level2">
<h2 class="anchored" data-anchor-id="data-tidying-eda">Data Tidying &amp; EDA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Annual means</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>conc.annual <span class="ot">&lt;-</span> nwis_wqp <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year=</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID, SiteName, year, parameter) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">annual_mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by 'SiteID', 'SiteName', 'year'. You can</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># EDA</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(conc.annual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(conc.annual<span class="sc">$</span>SiteID, conc.annual<span class="sc">$</span>parameter)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Bicarbonate Calcium Magnesium</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   USGS-09069000          61      77        77</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   USGS-09085000          45      49        49</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   USGS-09095500          72      85        85</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   USGS-09152500          79      87        87</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   USGS-09180000          42      65        65</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   USGS-09380000          81      85        85</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the data</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>conc.annual <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span>annual_mean,<span class="at">color=</span>SiteName)) <span class="sc">+</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter,<span class="at">scales=</span><span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'bottom'</span>) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggdensity</span>(conc.annual, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="st">"annual_mean"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> <span class="st">"SiteName"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">facet.by =</span> <span class="st">"parameter"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Long to wide, adding data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>conc.wide <span class="ot">&lt;-</span> conc.annual <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> parameter,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> annual_mean) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MgCa=</span>Magnesium<span class="sc">+</span>Calcium) </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Assumptions</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(conc.wide[, <span class="fu">c</span>(<span class="st">'Bicarbonate'</span>,<span class="st">'Magnesium'</span>,<span class="st">'Calcium'</span>, <span class="st">'MgCa'</span>)], </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span><span class="fu">shapiro.test</span>(.x)<span class="sc">$</span>p.value)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Bicarbonate    Magnesium      Calcium         MgCa </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2.641685e-08 2.166554e-19 1.024677e-16 1.035285e-18</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_cor</span>(<span class="fu">select</span>(conc.wide, is.numeric), <span class="at">cor_method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Use of bare predicate functions was deprecated in tidyselect 1.1.0.</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Please use wrap predicates in `where()` instead.</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   # Was:</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   data %&gt;% select(is.numeric)</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   # Now:</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   data %&gt;% select(where(is.numeric))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(conc.wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(conc.wide, <span class="fu">is.na</span>(Bicarbonate))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 77 × 7</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    SiteID        SiteName  year Bicarbonate Calcium Magnesium  MgCa</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;         &lt;chr&gt;    &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 USGS-09069000 Eagle     1979          NA    78.3      16.0  94.3</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 USGS-09069000 Eagle     1980          NA   100        21   121  </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 USGS-09069000 Eagle     1981          NA    75        14.1  89.1</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 USGS-09069000 Eagle     1982          NA    65.5      13.4  78.9</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 USGS-09069000 Eagle     1983          NA    94.3      18.3 113. </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 USGS-09069000 Eagle     1984          NA    65.5      14.5  80  </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 USGS-09069000 Eagle     1985          NA    84.5      18   102. </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 USGS-09069000 Eagle     1986          NA    80.2      17.0  97.2</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 USGS-09069000 Eagle     1987          NA    84.5      17.2 102. </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 USGS-09069000 Eagle     1988          NA    79        15.5  94.5</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 67 more rows</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>conc.wide <span class="ot">=</span> <span class="fu">drop_na</span>(conc.wide)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(conc.wide,<span class="fu">aes</span>(<span class="at">x=</span>Bicarbonate,<span class="at">y=</span>MgCa)) <span class="sc">+</span> </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>SiteName, <span class="at">scale =</span> <span class="st">"free"</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="feature-engineering" class="level3">
<h3 class="anchored" data-anchor-id="feature-engineering">Feature Engineering</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Help</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidy.outliers)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Engineering</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> conc.wide  <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_sqrt</span>(MgCa, Bicarbonate) <span class="sc">|&gt;</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_filter</span>(<span class="sc">!</span>SiteName <span class="sc">%in%</span> <span class="st">"Dolores"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_outliers_maha</span>(MgCa, Bicarbonate) <span class="sc">|&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_outliers_remove</span>(<span class="fu">contains</span>(r<span class="st">"(.outliers)"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(conc.wide)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">bake</span>(r, <span class="at">new_data =</span> <span class="cn">NULL</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># EDA</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(b)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 315</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 7</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ SiteID      &lt;chr&gt; "USGS-09069000", "USGS-09069000", "USGS-09069000", "USGS-0…</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ SiteName    &lt;chr&gt; "Eagle", "Eagle", "Eagle", "Eagle", "Eagle", "Eagle", "Eag…</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ year        &lt;dbl&gt; 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1956…</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Bicarbonate &lt;dbl&gt; 11.55061, 12.43041, 11.97169, 12.55070, 12.46842, 12.67450…</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Calcium     &lt;dbl&gt; 72.79167, 94.69697, 86.78571, 97.08333, 102.00000, 108.928…</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Magnesium   &lt;dbl&gt; 15.75833, 20.15758, 18.81786, 21.88333, 20.65385, 22.53571…</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ MgCa        &lt;dbl&gt; 9.410101, 10.717021, 10.276360, 10.907184, 11.074920, 11.4…</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(conc.wide)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 371</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 7</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ SiteID      &lt;chr&gt; "USGS-09069000", "USGS-09069000", "USGS-09069000", "USGS-0…</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ SiteName    &lt;chr&gt; "Eagle", "Eagle", "Eagle", "Eagle", "Eagle", "Eagle", "Eag…</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ year        &lt;dbl&gt; 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1956…</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Bicarbonate &lt;dbl&gt; 133.4167, 154.5152, 143.3214, 157.5200, 155.4615, 160.6429…</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Calcium     &lt;dbl&gt; 72.79167, 94.69697, 86.78571, 97.08333, 102.00000, 108.928…</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Magnesium   &lt;dbl&gt; 15.75833, 20.15758, 18.81786, 21.88333, 20.65385, 22.53571…</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ MgCa        &lt;dbl&gt; 88.55000, 114.85455, 105.60357, 118.96667, 122.65385, 131.…</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(b,<span class="fu">aes</span>(<span class="at">x=</span>Bicarbonate,<span class="at">y=</span>MgCa,<span class="at">color=</span>SiteName)) <span class="sc">+</span> </span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>SiteName, <span class="at">scale =</span> <span class="st">"free"</span>) </span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modeling-1" class="level3">
<h3 class="anchored" data-anchor-id="modeling-1">Modeling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bicarbonate Trends over the years</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>b <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">-</span>SiteName) <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mod =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(Bicarbonate <span class="sc">~</span> year, <span class="at">data =</span> .x)),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> <span class="fu">map</span>(mod, broom<span class="sc">::</span>tidy)) <span class="sc">|&gt;</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data, <span class="sc">-</span>mod) <span class="sc">|&gt;</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(summary) <span class="sc">|&gt;</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-3465ce00{}.cl-3461e2a4{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-34641966{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-34641970{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-34642406{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-34642407{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-34642410{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-34642411{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-34642412{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-34642413{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-3465ce00"><thead><tr style="overflow-wrap:break-word;"><th class="cl-34642406"><p class="cl-34641966"><span class="cl-3461e2a4">SiteName</span></p></th><th class="cl-34642406"><p class="cl-34641966"><span class="cl-3461e2a4">term</span></p></th><th class="cl-34642407"><p class="cl-34641970"><span class="cl-3461e2a4">estimate</span></p></th><th class="cl-34642407"><p class="cl-34641970"><span class="cl-3461e2a4">std.error</span></p></th><th class="cl-34642407"><p class="cl-34641970"><span class="cl-3461e2a4">statistic</span></p></th><th class="cl-34642407"><p class="cl-34641970"><span class="cl-3461e2a4">p.value</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Eagle</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">(Intercept)</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">39.57385972</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">4.386747659</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">9.021230</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.000000000001666369602781</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Eagle</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">year</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">-0.01399886</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.002210230</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">-6.333668</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.000000043332049866020944</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Roaring Fork</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">(Intercept)</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">40.55887785</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">9.596484598</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">4.226431</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.000129242080714668246093</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Roaring Fork</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">year</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">-0.01446147</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.004819051</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">-3.000896</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.004565782613797183218940</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Colorado 3</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">(Intercept)</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">42.66668735</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">3.538553116</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">12.057665</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.000000000000000001507047</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Colorado 3</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">year</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">-0.01526277</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.001788248</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">-8.535040</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.000000000002341725198104</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Gunnison</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">(Intercept)</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">51.46163885</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">7.326837474</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">7.023718</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.000000001817038439639663</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Gunnison</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">year</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">-0.01932269</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.003693120</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">-5.232079</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.000002038985041759279626</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">Colorado 5</span></p></td><td class="cl-34642410"><p class="cl-34641966"><span class="cl-3461e2a4">(Intercept)</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">43.11291594</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">5.111983594</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">8.433696</span></p></td><td class="cl-34642411"><p class="cl-34641970"><span class="cl-3461e2a4">0.000000000001483434518560</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34642412"><p class="cl-34641966"><span class="cl-3461e2a4">Colorado 5</span></p></td><td class="cl-34642412"><p class="cl-34641966"><span class="cl-3461e2a4">year</span></p></td><td class="cl-34642413"><p class="cl-34641970"><span class="cl-3461e2a4">-0.01516966</span></p></td><td class="cl-34642413"><p class="cl-34641970"><span class="cl-3461e2a4">0.002580801</span></p></td><td class="cl-34642413"><p class="cl-34641970"><span class="cl-3461e2a4">-5.877888</span></p></td><td class="cl-34642413"><p class="cl-34641970"><span class="cl-3461e2a4">0.000000100616720493792293</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bicarbonate vs. Magnesium + Calcium</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>b <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">-</span>SiteID)  <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mod =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(Bicarbonate <span class="sc">~</span> MgCa, <span class="at">data =</span> .x))) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mod.glance=</span><span class="fu">map</span>(mod,glance),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mod.tidy=</span><span class="fu">map</span>(mod,tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data, <span class="sc">-</span>mod) <span class="sc">|&gt;</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(mod.glance, mod.tidy) <span class="sc">|&gt;</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: `unnest()` has a new interface. See `?unnest` for details.</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Try `df %&gt;% unnest(c(mod.glance, mod.tidy))`, with `mutate()` if needed.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-347927ac{}.cl-3475302a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-34774504{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3477450e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-347757e2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347757e3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347757ec{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347757ed{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347757ee{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347757ef{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-347927ac"><thead><tr style="overflow-wrap:break-word;"><th class="cl-347757e2"><p class="cl-34774504"><span class="cl-3475302a">SiteID</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">r.squared</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">adj.r.squared</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">sigma</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">statistic</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">p.value</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">df</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">logLik</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">AIC</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">BIC</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">deviance</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">df.residual</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">nobs</span></p></th><th class="cl-347757e2"><p class="cl-34774504"><span class="cl-3475302a">term</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">estimate</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">std.error</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">statistic1</span></p></th><th class="cl-347757e3"><p class="cl-3477450e"><span class="cl-3475302a">p.value1</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09069000</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.6579555</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.6518476</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.3257045</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">107.7214</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000116764226254997670908369</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-16.21843</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">38.43686</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">44.61819</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">5.940672</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">56</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">58</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">(Intercept)</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">5.7729268</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.58149985</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">9.927650</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000594474770950825486787134699773</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09069000</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.6579555</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.6518476</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.3257045</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">107.7214</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000116764226254997670908369</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-16.21843</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">38.43686</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">44.61819</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">5.940672</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">56</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">58</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">MgCa</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.5922717</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.05706502</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">10.378892</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000116764226254999343293487859486</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09085000</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.8041263</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.7993489</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.3532772</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">168.3185</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000004200703977738731966281</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-15.24875</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">36.49751</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">41.78111</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">5.116995</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">41</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">43</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">(Intercept)</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">3.6309783</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.62909498</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">5.771749</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000009134308989728205915777656601073353215</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09085000</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.8041263</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.7993489</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.3532772</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">168.3185</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000004200703977738731966281</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-15.24875</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">36.49751</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">41.78111</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">5.116995</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">41</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">43</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">MgCa</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.9091823</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.07007853</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">12.973763</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000004200703977738611664993410798</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09095500</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.7073202</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.7030161</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.3126364</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">164.3358</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000820544045639745373</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-16.92113</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">39.84226</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">46.58775</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">6.646424</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">68</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">70</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">(Intercept)</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">5.6597650</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.53238561</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">10.630951</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000004222349621961471518942129889</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09095500</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.7073202</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.7030161</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.3126364</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">164.3358</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000820544045639745373</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-16.92113</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">39.84226</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">46.58775</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">6.646424</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">68</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">70</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">MgCa</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.7578407</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.05911692</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">12.819354</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000820544045639768845043502</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09152500</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.8506780</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.8483078</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.3489742</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">358.9070</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000000000010456819296</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-22.78608</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">51.57216</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">58.09532</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">7.672330</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">63</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">65</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">(Intercept)</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">6.2237860</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.36711301</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">16.953325</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000000003689726929567777565</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09152500</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.8506780</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.8483078</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.3489742</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">358.9070</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000000000010456819296</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-22.78608</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">51.57216</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">58.09532</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">7.672330</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">63</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">65</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">MgCa</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.5874517</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.03100853</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">18.944840</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000000000010456819295893397</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">USGS-09380000</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.8380254</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.8359218</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.2961462</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">398.3832</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000000000000000361665</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">-14.94800</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">35.89601</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">43.00435</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">6.753097</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">77</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">79</span></p></td><td class="cl-347757ec"><p class="cl-34774504"><span class="cl-3475302a">(Intercept)</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">7.1052767</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.30059144</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">23.637655</span></p></td><td class="cl-347757ed"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000000000000000000004877863</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-347757ee"><p class="cl-34774504"><span class="cl-3475302a">USGS-09380000</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">0.8380254</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">0.8359218</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">0.2961462</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">398.3832</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000000000000000361665</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">1</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">-14.94800</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">35.89601</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">43.00435</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">6.753097</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">77</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">79</span></p></td><td class="cl-347757ee"><p class="cl-34774504"><span class="cl-3475302a">MgCa</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">0.5867379</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">0.02939637</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">19.959538</span></p></td><td class="cl-347757ef"><p class="cl-3477450e"><span class="cl-3475302a">0.0000000000000000000000000000000361664988382</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictive model</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> b <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">-</span>SiteName)  <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mod =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(Bicarbonate <span class="sc">~</span> MgCa, <span class="at">data =</span> .x)),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">a =</span> <span class="fu">map2</span>(mod, data, <span class="sc">~</span><span class="fu">augment</span>(.x, .y))) <span class="sc">|&gt;</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(a)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vizualize model and assumptions</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(a, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> Bicarbonate)) <span class="sc">+</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>SiteName, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">gghistogram</span>(a, <span class="at">x =</span> <span class="st">".resid"</span>, <span class="at">fill =</span> <span class="st">"SiteName"</span>, <span class="at">facet.by =</span> <span class="st">"SiteID"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Using `bins = 30` by default. Pick better value with the argument</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `bins`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>What did we find? Did this align with our expectations? Did the process we just go through make sense? Did any of the skills seem alien?</p>
</section>
<section id="assignment" class="level2">
<h2 class="anchored" data-anchor-id="assignment">Assignment</h2>
<p>As we have reached the half way point of this course, take a moment to reflect on your journey so far. Please respond to each of the following prompts in a few sentences. The questions are guiding but not all need to be answered directly and deviations are welcome</p>
<p><strong>1. Unit 1</strong>: Think back to the beginning—how comfortable were you with setting up and using R, RStudio, Git, and GitHub? Do you now feel more confident in managing your computational environment and organizing your data? What aspects still feel challenging or unclear? Do you feel that the skills learned are transitioning into other areas of your “computational life”?</p>
<p><strong>2. Unit 2 </strong>: As we wrap up our primary unit on data wrangling, visualization, and analysis, how do you feel about your ability to import, clean, and work with data? Are there specific techniques (joins, visualizations, statistical methods, nests/groups) that you feel you’ve improved on? Thinking back 8 weeks, are you proud of the progress you’ve made or feeling lost? What areas do you want to focus on strengthening as we continue?</p>
<p><strong>3. Looking Ahead:</strong>: Are you making the progress you hoped for? If not, what barriers are you facing, and what steps could help you overcome them? If yes, what strategies have been working for you? What are your goals for the remainder of the course and how can the teaching team best support you in reaching them?</p>
<p><strong>4. Modes of Learning</strong>: How do you feel about the methods in which content is shared? Have lectures been useful? Labs? Office hours? Daily Exercises? What would you like to see continue, and what would you like us to consider changing to help your growth?</p>
<p>We know the learning curve with coding is STEEP!, but if you feel you are hanging on, I promise you are doing well.</p>
<p>Please be honest with yourself (and with us) in this reflection—there are no wrong answers! This is an opportunity to take stock of your growth and identify where you’d like to go next, and, for us to adopt to how we support you best.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>